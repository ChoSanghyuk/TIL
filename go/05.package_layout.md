# Go Package Layout



Go projects can include packages, command-line programs or a combination of the two



### Basic package

A basic Go package has all its code in the project’s root directory. The project consists of a single module

The **package name matches the last path component** of the module name

```
project-root-directory/
  go.mod
  modname.go
  modname_test.go
```

- modname.go

  ```go
  package modname
  
  // ... package code here
  ```



### Basic command

The **simplest program can consist of a single Go file** where `func main` is defined

```
project-root-directory/
  go.mod
  auth.go
  auth_test.go
  client.go
  main.go
```

- The “main” file can also be called `modname.go` 

- `go.mod` file should say modname



### Package or command with supporting packages

Larger packages or commands may benefit from **splitting off some functionality into supporting packages**. 

```go
project-root-directory/
  internal/
    auth/
      auth.go
      auth_test.go
    hash/
      hash.go
      hash_test.go
  go.mod
  modname.go
  modname_test.go
```

- `internal`
  - it’s recommended placing such packages into a directory named `internal`
  - this **prevents other modules from depending on packages** we don’t necessarily want to expose and support for external uses.

:bulb: 외부로 노출해도 될 library code는 `pkg` 하위로 두는 것으로 소개된 글도 있으나, 현재 글에서는 보이지 않음

- 예전 글 : https://github.com/golang-standards/project-layout/tree/master



### Multiple packages

A module can consist of multiple importable packages; each package has its own directory, and can be structured hierarchically. 

```
project-root-directory/
  go.mod
  modname.go
  modname_test.go
  auth/
    auth.go
    auth_test.go
    token/
      token.go
      token_test.go
  hash/
    hash.go
  internal/
    trace/
      trace.go
```

- 결국 importable packages은 바로 하위에 두는 것으로 보임



### Multiple commands

Multiple programs in the same repository will typically have separate directories:

```
project-root-directory/
  go.mod
  internal/
    ... shared internal packages
  prog1/
    main.go
  prog2/
    main.go
```



### Packages and commands in the same repository

Sometimes a repository will provide both importable packages and installable commands with related functionality

```
project-root-directory/
  go.mod
  modname.go
  modname_test.go
  auth/
    auth.go
    auth_test.go
  internal/
    ... internal packages
  cmd/
    prog1/
      main.go
    prog2/
      main.go
```



### Server project

Go is a common language choice for implementing servers.

**Server projects typically won’t have packages for export**, since a server is usually a self-contained binary (or a group of binaries). Therefore, it’s recommended to keep the Go packages implementing the server’s logic in the `internal` directory. Moreover, since the project is likely to have many other directories with non-Go files, it’s a good idea to keep all Go commands together in a `cmd` directory

```
project-root-directory/
  go.mod
  internal/
    auth/
      ...
    metrics/
      ...
    model/
      ...
  cmd/
    api-server/
      main.go
    metrics-analyzer/
      main.go
    ...
  ... the project's other directories with non-Go code
```





## 출처

https://go.dev/doc/modules/layout
